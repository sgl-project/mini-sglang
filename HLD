                    ┌──────────────────────────────────────┐
                    │                        │
                    │                                      │
                    │  server/     → HTTP & Process mgmt   │
                    │  tokenizer/  → Text ↔ Tokens         │
                    │  core.py     → Data structures       │
                    │                                      │
                    └──────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                        NEXT LAYER (Core Logic)                          │
│                                                                         │
│   ┌─────────────┐    ┌─────────────────┐    ┌─────────────────────┐    │
│   │ message.py  │───►│  scheduler.py   │───►│     engine.py       │    │
│   │             │    │                 │    │                     │    │
│   │ ZMQ message │    │ THE BRAIN ⭐    │    │ Forward pass        │    │
│   │ types       │    │ Batching        │    │ CUDA graphs         │    │
│   │             │    │ Memory mgmt     │    │                     │    │
│   └─────────────┘    └─────────────────┘    └─────────────────────┘    │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                        DEEP LAYER (Model & Infra)                       │
│                                                                         │
│   ┌─────────────┐    ┌─────────────────┐    ┌─────────────────────┐    │
│   │  models/    │    │   attention/    │    │     kvcache/        │    │
│   │             │    │                 │    │                     │    │
│   │ Llama/Qwen  │    │ FlashAttention  │    │ Radix cache         │    │
│   │ architecture│    │ FlashInfer      │    │ Memory pool         │    │
│   └─────────────┘    └─────────────────┘    └─────────────────────┘    │
│                                                                         │
│   ┌─────────────┐    ┌─────────────────┐                               │
│   │  layers/    │    │  distributed.py │                               │
│   │             │    │                 │                               │
│   │ TP-aware    │    │ NCCL wrappers   │                               │
│   │ Linear/Emb  │    │ all_reduce      │                               │
│   └─────────────┘    └─────────────────┘                               │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
